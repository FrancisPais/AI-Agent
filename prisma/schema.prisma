generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                       String    @id @default(cuid())
  email                    String    @unique
  googleAccountId          String?   @unique
  googleAccessToken        String?
  googleRefreshToken       String?
  googleTokenExpiresAt     DateTime?
  youtubeCookies           String?
  youtubeCookiesCreatedAt  DateTime?
  youtubeCookiesLastUsedAt DateTime?
  createdAt                DateTime  @default(now())
  updatedAt                DateTime  @updatedAt
  videos                   Video[]
}

model Video {
  id           String   @id @default(cuid())
  userId       String
  sourceUrl    String
  title        String
  durationSec  Int
  status       String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  transcript   Json?
  clips        Clip[]
  user         User     @relation(fields: [userId], references: [id])
  @@index([userId])
}

model Clip {
  id             String   @id @default(cuid())
  videoId        String
  startSec       Int
  endSec         Int
  durationSec    Int
  category       String
  tags           String[]
  scoreHook      Int
  scoreRetention Int
  scoreClarity   Int
  scoreShare     Int
  scoreOverall   Int
  rationale      String
  s3VideoKey     String
  s3ThumbKey     String
  s3SrtKey       String
  createdAt      DateTime @default(now())
  Video          Video    @relation(fields: [videoId], references: [id])
  @@index([videoId])
}
